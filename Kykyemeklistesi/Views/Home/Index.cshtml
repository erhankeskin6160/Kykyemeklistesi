    @using System.Globalization
    @using Kykyemeklistesi.Controllers
    @model List<Yemek>
    <!DOCTYPE html>
    <html lang="tr">

    @{
        var sehir = ViewBag.SelectedCity;
        var sayac = 0;
        Layout = "~/Views/Shared/_Layout.cshtml";

    }

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="google-adsense-account" content="ca-pub-5290089711270021">
        <meta name="description" content="KYK yemek listesi ile yurtlardaki öğrenciler için günlük yemek menülerini görüntüleyin. Sabah ve akşam yemeklerini takip edin, duyuruları kaçırmayın.">
        <meta name="keywords" content="KYK yemek listesi, KYK yemek menüsü, öğrenci yemek listesi, günlük yemek menüsü, KYK duyuruları, KYK yurt yemekleri">
        <title>@($"{sehir} - KYK Yemek Menüsü - kykyemeklistesi.com.tr")</title>
        <link rel="canonical" href="https://kykyemeklistesi.com.tr/@ViewBag.SelectedCity.ToLower()-yemek-listesi">

        <link rel="stylesheet" href="/css/fontawesome.css">
        <link rel="stylesheet" href="/css/bootstrap.css">
        <link rel="stylesheet" href="/css/styles.css">    

        <meta name="verify-admitad" content="cab80166e8" /> 
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-20V1RRPVZ1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag() { dataLayer.push(arguments); }
            gtag('js', new Date());
            gtag('config', 'G-20V1RRPVZ1');
        </script>
    

        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5290089711270021" crossorigin="anonymous"></script>
            <meta name='impact-site-verification' value='611f25ec-1d6e-43d4-8ff5-5c5e90ae0ce4'>

        
    </head>

    <body>
    <div class="container-xl   ps-2 pe-5 ps-md-3 pe-md-5  ">

        <div class="d-flex justify-content-center align-items-center">
            <div>
                @if (User.Identity.IsAuthenticated)
                {
                @*   <a href="@Url.Action("ExportToExcel", "User", new { selectedCity = ViewBag.SelectedCity })" class="btn btn-success pdfexcel" id="excel">
                        <i class="fa-regular fa-file-excel pdfexcel-text"></i>
                        <p class="fw-bolder pdfexceltext">Excel İle İndir</p>
                    </a>

                    <a href="@Url.Action("ExportToPdf", "User", new { selectedCity = ViewBag.SelectedCity })" class="btn btn-danger pdfexcel">
                        <i class="fa-regular fa-file-pdf pdfexcel-text"></i>
                        <p class="fw-bolder pdfexceltext">PDF İle İndir</p>
                    </a> *@
                }
            </div>

            <!--AdFox START-->
            <div id="adfox_173663303180681358"></div>
            <script>
                window.yaContextCb.push(() => {
                    Ya.adfoxCode.create({
                        ownerId: 11654074,
                        containerId: 'adfox_173663303180681358',
                        params: {
                            pp: 'g',
                            ps: 'irvl',
                            p2: 'hukd'
                        }
                    })
                })
            </script>
        </div>


        <div class="main-layout d-flex flex-lg-row flex-column mx-auto justify-content-lg-center  justify-content-center ps-sm-3">
            <!-- Sol Reklam Alanı -->

                        <div class="ad-section-left d-lg-none">
                                <div class="ad-content">
                                    
                                    <div class="adsense-wrapper ">
                                        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5290089711270021"
                                                crossorigin="anonymous"></script>
                                        <!-- Ana Sayfa Reklam -->
                                        <ins class="adsbygoogle d-flex flex-column align-items-center justify-content-center w-100 h-50"
                                            data-ad-format="auto"
                                            data-ad-client="ca-pub-5290089711270021"
                                            data-ad-slot="6742700105"></ins>
                                        <script>
                                            (adsbygoogle = window.adsbygoogle || []).push({});
                                        </script>

                                        
                                    </div>
                                
                                </div>
                            </div>

            <aside class="sidebar d-none d-lg-block p-0 ms-5" aria-label="Sol reklam alanı">
                <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5290089711270021" crossorigin="anonymous"></script>
                <ins class="d-none d-lg-block adsbygoogle"
                    style="display:inline-block;width:248px;height:520px"
                    data-ad-client="ca-pub-5290089711270021"
                    data-ad-slot="4756814293"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>
            </aside>
            <!-- Ana İçerik -->
            <main class="content-area  d-flex flex-column px-sm-2" aria-label="Ana içerik alanı">
                <div id="monthly-page">
                    <header class="page-title">
                        <h1>@ViewBag.SelectedCity  Kyk 30 Günlük Yemek Menüsü</h1>
                        <p>@ViewBag.SelectedCity @DateTime.Now.ToString("MMMM") ayı kyk yemek listesi</p>
                    </header>

                    <form method="get" action="/Home/Index">
                        <div class="controls-section d-flex flex-column  justify-content-center align-items-center gap-3 text-center my-3">
                            <div class="city-selector text-center">
                                <label for="selectedCity">Şehir Seçin:</label>
                                <select name="selectedCity" id="selectedCity" class="city-dropdown" onchange="this.form.submit()">
                                    @foreach (var item in ViewBag.City as List<SelectListItem>)
                                    {
                                        if (item.Selected)
                                        {
                                            <option value="@item.Value" selected>@item.Text</option>

                                        }
                                        else
                                        {
                                            <option value="@item.Value">@item.Text</option>

                                        }
                                    }
                                </select>
                            </div>

                            <div class="filter-buttons">
                                <button type="button" class="filter-btn active" onclick="filterMeals('all')">Tümü</button>
                                <button type="button" class="filter-btn" onclick="filterMeals('breakfast')">Kahvaltı</button>
                                <button type="button" class="filter-btn" onclick="filterMeals('dinner')">Sadece Akşam</button>
                            </div>
                        </div>
                    </form>

                    @foreach (var item in Model)
                    {
                        sayac++;
                        var istoday = item.Day.ToLongDateString() == DateTime.Now.Date.ToLongDateString();
                    
                        <div class="menu-grid mt-4  flex-md-row flex-column mx-auto">
                            <article class="day-section @(istoday ? "today-meal":"")">
                                <div class="day-header">
                                    <div class="day-info">
                                        <div class="day-number">@item.Day.ToString("dd")</div>
                                        <div>
                                            <div class="day-date">@item.Day.ToString("MMMM yyyy")</div>
                                            <div class="day-name">@item.Day.ToString("dddd")</div>
                                        </div>
                                    </div>
                                </div>

                                <div class="meals-container mt-3 d-flex flex-md-row flex-column mx-auto">
                                    <!-- Kahvaltı Kartı -->
                                    <div class="meal-card breakfast">
                                        <div class="meal-header">
                                            <div class="meal-title">
                                                <div class="meal-icon breakfast-icon" aria-hidden="true">☀️</div>
                                                <h3 class="meal-name">Kahvaltı</h3>
                                            </div>
                                            <div class="calorie-badge">@item.SabahCalorie kalori</div>
                                        </div>
                                        <ul class="menu-items">
                                            @if (!string.IsNullOrEmpty(item.SabahYemekListesi))
                                            {
                                                @foreach (var sabahyemek in item.SabahYemekListesi.Split('\n'))
                                                {
                                                    <li class="menu-item">@sabahyemek.Trim()</li>
                                                }
                                            }
                                            else
                                            {
                                                <li class="menu-item">Ürün Daha Eklenmedi</li>
                                            }
                                        </ul>
                                    </div>

                                    <!-- Akşam Yemeği Kartı -->
                                    <div class="meal-card dinner">
                                        <div class="meal-header">
                                            <div class="meal-title">
                                                <div class="meal-icon dinner-icon" aria-hidden="true">🌙</div>
                                                <h3 class="meal-name">Akşam</h3>
                                            </div>
                                            <div class="calorie-badge">@item.AksamCaloriee kalori</div>
                                        </div>
                                        <ul class="menu-items">
                                            @if (!string.IsNullOrEmpty(item.AksamYemekListesi))
                                            {
                                                @foreach (var aksamyemek in item.AksamYemekListesi.Split('\n'))
                                                {
                                                    <li class="menu-item">@aksamyemek.Trim()</li>
                                                }
                                            }
                                            else
                                            {
                                                <li class="menu-item">Ürün Daha Eklenmedi</li>
                                            }
                                        </ul>
                                    </div>
                                </div>
                            </article>
                        </div>

                        <hr />

                        @if (sayac % 3 == 0)
                        {
                            <div class="ad-section">
                                <div class="ad-content">
                                    <div class="ad-label">Reklam</div>
                                    <div class="adsense-wrapper">
                                        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5290089711270021"
                                                crossorigin="anonymous"></script>
                                        <!-- Ana Sayfa Reklam -->
                                        <ins class="adsbygoogle d-flex flex-column align-items-center justify-content-center w-100 h-100"
                                            data-ad-format="auto"

                                            data-ad-client="ca-pub-5290089711270021"
                                            data-ad-slot="6742700105"></ins>
                                        <script>
                                            (adsbygoogle = window.adsbygoogle || []).push({});
                                        </script>

                                        
                                    </div>
                                
                                </div>
                            </div>
                            <hr />
                        }
                    }
                </div>

                <!-- Diğer sayfalar -->
                <div id="home-page" class="hidden">
                    <div class="page-title">
                        <h1>KYK Yemek Menüsü</h1>
                        <p>Hoş geldiniz! Günlük menüleri takip edin.</p>
                    </div>
                    <div style="text-align: center; padding: 3rem;">
                        <p>Ana sayfa içeriği burada olacak...</p>
                    </div>
                </div>

                <div id="today-page" class="hidden">
                    <div class="page-title">

                        <h1>Bugünkü Menü</h1>
                        <p>31 Mayıs 2025 - Cumartesi</p>
                    </div>
                    <div style="text-align: center; padding: 3rem;">
                        <p>Bugünkü menü içeriği burada olacak...</p>
                    </div>
                </div>

                <div id="stats-page" class="hidden">
                    <div class="page-title">
                        <h1>İstatistikler</h1>
                        <p>Beslenme analizi ve raporlar</p>
                    </div>
                    <div style="text-align: center; padding: 3rem;">
                        <p>İstatistik grafikleri burada olacak...</p>
                    </div>
                </div>
            </main>

            <!-- Sağ Reklam Alanı -->
            
                          <div class="ad-section-left d-lg-none">
                                <div class="ad-content">
                                    
                                    <div class="adsense-wrapper ">
                                        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5290089711270021"
                                                crossorigin="anonymous"></script>
                                        <!-- Ana Sayfa Reklam -->
                                        <ins class="adsbygoogle d-flex flex-column align-items-center justify-content-center w-100 h-50 p-1"
                                            data-ad-format="auto"
                                            data-ad-client="ca-pub-5290089711270021"
                                            data-ad-slot="6742700105"></ins>
                                        <script>
                                            (adsbygoogle = window.adsbygoogle || []).push({});
                                        </script>

                                        
                                    </div>
                                
                                </div>
                            </div>


            <div class="sidebar p-0 d-none d-lg-block" aria-label="Sağ reklam alanı">

                <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5290089711270021" crossorigin="anonymous"></script>
                <ins class="adsbygoogle d-none d-lg-block"
                    style="display:inline-block;width:248px;height:520px"
                    data-ad-client="ca-pub-5290089711270021"
                    data-ad-slot="4756814293"></ins>
                <script>
                    (adsbygoogle = window.adsbygoogle || []).push({});
                </script>

            </div>

        
    </div>

            
    
    </div>

        <!-- JavaScript -->
        <script>
            // Mevcut filtre durumu
            let currentFilter = 'all';

            function filterMeals(type) {
                currentFilter = type;

                // Aktif buton stilini güncelle
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.classList.remove('active');
                });

                // Aktif butonu bul ve işaretle
                const activeBtn = document.querySelector(`[onclick="filterMeals('${type}')"]`);
                if (activeBtn) {
                    activeBtn.classList.add('active');
                }

                applyFilters();
            }

            function applyFilters() {
                const daySections = document.querySelectorAll('.day-section');

                daySections.forEach(daySection => {
                    let dayHasVisibleMeals = false;
                    const mealsContainer = daySection.querySelector('.meals-container');
                    const breakfastCard = daySection.querySelector('.meal-card.breakfast');
                    const dinnerCard = daySection.querySelector('.meal-card.dinner');

                    // Kahvaltı kartını göster/gizle
                    if (breakfastCard) {
                        const shouldShowBreakfast = currentFilter === 'all' || currentFilter === 'breakfast';
                        breakfastCard.style.display = shouldShowBreakfast ? 'block' : 'none';
                        if (shouldShowBreakfast) dayHasVisibleMeals = true;
                    }

                    // Akşam yemeği kartını göster/gizle  
                    if (dinnerCard) {
                        const shouldShowDinner = currentFilter === 'all' || currentFilter === 'dinner';
                        dinnerCard.style.display = shouldShowDinner ? 'block' : 'none';
                        if (shouldShowDinner) dayHasVisibleMeals = true;
                    }

                    // Grid düzenini ayarla (sadece desktop'ta)
                    if (mealsContainer && window.innerWidth > 768) {
                        if (currentFilter === 'breakfast' || currentFilter === 'dinner') {
                            mealsContainer.style.gridTemplateColumns = '1fr';
                            if (breakfastCard) {
                                breakfastCard.style.width = '100%';
                                breakfastCard.style.maxWidth = '100%';
                            }
                            if (dinnerCard) {
                                dinnerCard.style.width = '100%';
                                dinnerCard.style.maxWidth = '100%';
                            }
                        } else {
                            mealsContainer.style.gridTemplateColumns = '1fr 1fr';
                            if (breakfastCard) {
                                breakfastCard.style.width = '';
                                breakfastCard.style.maxWidth = '';
                            }
                            if (dinnerCard) {
                                dinnerCard.style.width = '';
                                dinnerCard.style.maxWidth = '';
                            }
                        }
                    }

                    // Günü göster/gizle
                    daySection.style.display = dayHasVisibleMeals ? 'block' : 'none';
                });
            }

            // Sayfa yüklendiğinde ve pencere boyutu değiştiğinde
            document.addEventListener('DOMContentLoaded', applyFilters);
            window.addEventListener('resize', applyFilters);
        </script>
        <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
        <script src="~/js/script.js"></script>
    </body>
</html>